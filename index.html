<!-- 
  This file is not used. 
  The MERN app is in /frontend and /backend folders.
  
  To run:
  - Backend: cd backend && npm run dev
  - Frontend: cd frontend && npm run dev
-->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PixelSphere - See README</title>
</head>
<body style="background:#000;color:#fff;font-family:sans-serif;display:flex;align-items:center;justify-content:center;height:100vh;margin:0;">
    <div style="text-align:center;">
        <h1>PixelSphere</h1>
        <p>This is not the app. Run the MERN stack:</p>
        <pre style="background:#1a1a1a;padding:20px;border-radius:10px;text-align:left;">
cd backend && npm run dev   # Port 6000
cd frontend && npm run dev  # Port 5173
        </pre>
    </div>
</body>
</html>
        * {
            font-family: 'Inter', sans-serif;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        ::-webkit-scrollbar-thumb {
            background: #404040;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Animated Sphere */
        .sphere-container {
            perspective: 1000px;
        }
        
        .sphere {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 50%, #a0a0a0 100%);
            box-shadow: 
                inset -20px -20px 40px rgba(0,0,0,0.3),
                inset 20px 20px 40px rgba(255,255,255,0.5),
                0 30px 60px rgba(0,0,0,0.4),
                0 0 100px rgba(255,255,255,0.1);
            animation: float 4s ease-in-out infinite;
            transform-style: preserve-3d;
            transition: transform 0.3s ease;
        }
        
        .sphere::before {
            content: '';
            position: absolute;
            top: 15%;
            left: 20%;
            width: 30%;
            height: 20%;
            background: radial-gradient(ellipse, rgba(255,255,255,0.8) 0%, transparent 70%);
            border-radius: 50%;
        }
        
        .sphere::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.2) 50%, transparent 60%);
        }
        
        .sphere:hover {
            transform: rotateX(15deg) rotateY(15deg);
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0) rotateZ(0deg);
            }
            50% {
                transform: translateY(-20px) rotateZ(5deg);
            }
        }
        
        /* Gradient Background */
        .auth-gradient {
            background: radial-gradient(ellipse at top, #1a1a1a 0%, #000000 50%, #0a0a0a 100%);
        }
        
        /* Page Transitions */
        .page-enter {
            animation: slideIn 0.4s ease forwards;
        }
        
        .page-exit {
            animation: slideOut 0.3s ease forwards;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideOut {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(-30px);
            }
        }
        
        /* Auth Page Slide */
        .auth-slide-left {
            animation: authSlideLeft 0.5s ease forwards;
        }
        
        .auth-slide-right {
            animation: authSlideRight 0.5s ease forwards;
        }
        
        @keyframes authSlideLeft {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes authSlideRight {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* Micro-interactions */
        .btn-hover {
            transition: all 0.2s ease;
        }
        .btn-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255,255,255,0.15);
        }
        .btn-hover:active {
            transform: translateY(0);
        }
        
        /* Card Hover */
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        /* Typing Indicator */
        .typing-dot {
            animation: typingBounce 1.4s infinite ease-in-out both;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        .typing-dot:nth-child(3) { animation-delay: 0s; }
        
        @keyframes typingBounce {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        
        /* Pulse Animation */
        .pulse-dot {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
        }
        
        /* Skeleton Loader */
        .skeleton {
            background: linear-gradient(90deg, #2a2a2a 25%, #3a3a3a 50%, #2a2a2a 75%);
            background-size: 200% 100%;
            animation: skeleton 1.5s infinite;
        }
        
        @keyframes skeleton {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Hide scrollbar for stories */
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        
        /* Image Grid */
        .profile-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
        }
        
        @media (min-width: 768px) {
            .profile-grid {
                gap: 8px;
            }
        }
    </style>
</head>
<body class="bg-black text-white min-h-screen">
    <div id="app"></div>

    <script>
        // ==================== STATE MANAGEMENT ====================
        const state = {
            currentPage: 'login',
            isAuthenticated: false,
            user: null,
            users: [
                { id: 1, username: 'alex_design', displayName: 'Alex Designer', avatar: 'https://i.pravatar.cc/150?img=1', bio: 'UI/UX Designer | Creative Mind', followers: 12400, following: 890, posts: 45, role: 'creator', isFollowing: false },
                { id: 2, username: 'sarah_photo', displayName: 'Sarah Photography', avatar: 'https://i.pravatar.cc/150?img=2', bio: 'Capturing moments âœ¨', followers: 8900, following: 432, posts: 128, role: 'creator', isFollowing: true },
                { id: 3, username: 'mike_dev', displayName: 'Mike Developer', avatar: 'https://i.pravatar.cc/150?img=3', bio: 'Code is poetry ðŸ’»', followers: 5600, following: 234, posts: 23, role: 'consumer', isFollowing: false },
                { id: 4, username: 'emma_art', displayName: 'Emma Artist', avatar: 'https://i.pravatar.cc/150?img=4', bio: 'Digital Art | Illustrations', followers: 23000, following: 156, posts: 89, role: 'creator', isFollowing: true },
                { id: 5, username: 'admin_pixel', displayName: 'PixelSphere Admin', avatar: 'https://i.pravatar.cc/150?img=5', bio: 'Official Admin Account', followers: 50000, following: 10, posts: 5, role: 'admin', isFollowing: false }
            ],
            posts: [
                { id: 1, userId: 1, image: 'https://picsum.photos/600/600?random=1', caption: 'New design project coming soon! ðŸŽ¨ #design #creative', likes: 1234, comments: 56, shares: 12, liked: false, saved: false, createdAt: new Date(Date.now() - 3600000) },
                { id: 2, userId: 2, image: 'https://picsum.photos/600/750?random=2', caption: 'Golden hour magic âœ¨ @alex_design check this out!', likes: 2890, comments: 123, shares: 45, liked: true, saved: true, createdAt: new Date(Date.now() - 7200000) },
                { id: 3, userId: 4, image: 'https://picsum.photos/600/600?random=3', caption: 'Latest digital artwork - "Ethereal Dreams"', likes: 5670, comments: 234, shares: 89, liked: false, saved: false, createdAt: new Date(Date.now() - 86400000) },
                { id: 4, userId: 1, image: 'https://picsum.photos/600/800?random=4', caption: 'Minimalist vibes for the win ðŸ–¤', likes: 890, comments: 34, shares: 8, liked: true, saved: false, createdAt: new Date(Date.now() - 172800000) },
            ],
            messages: [
                { id: 1, recipientId: 2, messages: [
                    { id: 1, senderId: 2, text: 'Hey! Love your latest work!', time: new Date(Date.now() - 3600000), status: 'seen' },
                    { id: 2, senderId: 'me', text: 'Thank you so much! ðŸ™', time: new Date(Date.now() - 3500000), status: 'seen' },
                    { id: 3, senderId: 2, text: 'Would you be interested in a collab?', time: new Date(Date.now() - 3400000), status: 'delivered' },
                ], unread: 1, typing: false },
                { id: 2, recipientId: 4, messages: [
                    { id: 1, senderId: 4, text: 'Your designs are incredible!', time: new Date(Date.now() - 86400000), status: 'seen' },
                    { id: 2, senderId: 'me', text: 'Thanks Emma! Your art inspires me', time: new Date(Date.now() - 86300000), status: 'seen' },
                ], unread: 0, typing: true },
            ],
            notifications: [
                { id: 1, type: 'like', userId: 2, postId: 1, time: new Date(Date.now() - 1800000), read: false },
                { id: 2, type: 'follow', userId: 3, time: new Date(Date.now() - 3600000), read: false },
                { id: 3, type: 'comment', userId: 4, postId: 2, comment: 'Amazing shot!', time: new Date(Date.now() - 7200000), read: true },
            ],
            searchQuery: '',
            activeChat: null,
            selectedPost: null,
            showNotifications: false,
            authDirection: 'right'
        };

        // ==================== UTILITY FUNCTIONS ====================
        const formatTime = (date) => {
            const now = new Date();
            const diff = now - new Date(date);
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m`;
            if (hours < 24) return `${hours}h`;
            if (days < 7) return `${days}d`;
            return new Date(date).toLocaleDateString();
        };

        const formatNumber = (num) => {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        };

        const getUser = (id) => state.users.find(u => u.id === id);

        // ==================== COMPONENTS ====================
        
        // Animated Sphere Component
        const AnimatedSphere = () => `
            <div class="sphere-container relative">
                <div class="sphere relative cursor-pointer"></div>
                <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2 w-32 h-4 bg-gradient-to-r from-transparent via-white/10 to-transparent rounded-full blur-sm"></div>
            </div>
        `;

        // Loader Component
        const Loader = () => `
            <div class="flex items-center justify-center p-8">
                <div class="w-8 h-8 border-2 border-white/20 border-t-white rounded-full animate-spin"></div>
            </div>
        `;

        // Navbar Component
        const Navbar = () => `
            <nav class="fixed top-0 left-0 right-0 h-16 bg-black/90 backdrop-blur-lg border-b border-white/10 z-50 px-4 lg:px-8">
                <div class="max-w-7xl mx-auto h-full flex items-center justify-between">
                    <div class="flex items-center gap-2 cursor-pointer" onclick="navigate('feed')">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-br from-white to-gray-400 flex items-center justify-center">
                            <span class="text-black font-bold text-sm">P</span>
                        </div>
                        <span class="font-bold text-xl hidden sm:block">PixelSphere</span>
                    </div>
                    
                    <div class="hidden md:flex items-center bg-white/5 rounded-xl px-4 py-2 w-64 lg:w-80">
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                        <input type="text" placeholder="Search users..." class="bg-transparent border-none outline-none ml-3 text-sm w-full" oninput="handleSearch(this.value)" />
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <button onclick="navigate('feed')" class="p-2 hover:bg-white/10 rounded-xl transition hidden md:block">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                            </svg>
                        </button>
                        <button onclick="navigate('messages')" class="p-2 hover:bg-white/10 rounded-xl transition relative hidden md:block">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                            </svg>
                            ${state.messages.reduce((acc, m) => acc + m.unread, 0) > 0 ? `
                                <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full pulse-dot"></span>
                            ` : ''}
                        </button>
                        <button onclick="toggleNotifications()" class="p-2 hover:bg-white/10 rounded-xl transition relative">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                            </svg>
                            ${state.notifications.filter(n => !n.read).length > 0 ? `
                                <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full pulse-dot"></span>
                            ` : ''}
                        </button>
                        <div onclick="navigate('profile')" class="w-9 h-9 rounded-full bg-gradient-to-br from-gray-300 to-gray-600 cursor-pointer overflow-hidden">
                            <img src="${state.user?.avatar || 'https://i.pravatar.cc/150?img=8'}" class="w-full h-full object-cover" />
                        </div>
                    </div>
                </div>
                
                ${state.showNotifications ? NotificationPanel() : ''}
            </nav>
        `;

        // Notification Panel
        const NotificationPanel = () => `
            <div class="absolute top-16 right-4 w-80 bg-neutral-900 rounded-2xl shadow-2xl border border-white/10 overflow-hidden">
                <div class="p-4 border-b border-white/10">
                    <h3 class="font-semibold">Notifications</h3>
                </div>
                <div class="max-h-96 overflow-y-auto">
                    ${state.notifications.map(n => {
                        const user = getUser(n.userId);
                        return `
                            <div class="p-4 hover:bg-white/5 transition flex items-center gap-3 ${!n.read ? 'bg-white/5' : ''}">
                                <img src="${user.avatar}" class="w-10 h-10 rounded-full" />
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm">
                                        <span class="font-semibold">${user.username}</span>
                                        ${n.type === 'like' ? 'liked your post' : n.type === 'follow' ? 'started following you' : `commented: "${n.comment}"`}
                                    </p>
                                    <p class="text-xs text-gray-500">${formatTime(n.time)}</p>
                                </div>
                                ${!n.read ? '<span class="w-2 h-2 bg-blue-500 rounded-full"></span>' : ''}
                            </div>
                        `;
                    }).join('')}
                </div>
            </div>
        `;

        // Sidebar Component (Desktop)
        const Sidebar = () => `
            <aside class="hidden lg:flex fixed left-0 top-16 bottom-0 w-64 bg-black border-r border-white/10 flex-col p-4">
                <nav class="flex-1 space-y-2">
                    ${[
                        { icon: 'M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6', label: 'Home', page: 'feed' },
                        { icon: 'M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z', label: 'Search', page: 'search' },
                        { icon: 'M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z', label: 'Messages', page: 'messages', badge: state.messages.reduce((acc, m) => acc + m.unread, 0) },
                        { icon: 'M12 4v16m8-8H4', label: 'Create', page: 'create' },
                        { icon: 'M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z', label: 'Profile', page: 'profile' },
                    ].map(item => `
                        <button onclick="navigate('${item.page}')" class="w-full flex items-center gap-4 px-4 py-3 rounded-xl hover:bg-white/10 transition ${state.currentPage === item.page ? 'bg-white/10' : ''}">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${item.icon}"/>
                            </svg>
                            <span class="font-medium">${item.label}</span>
                            ${item.badge ? `<span class="ml-auto bg-red-500 text-xs px-2 py-0.5 rounded-full">${item.badge}</span>` : ''}
                        </button>
                    `).join('')}
                </nav>
                
                ${state.user?.role === 'admin' ? `
                    <div class="border-t border-white/10 pt-4 mt-4">
                        <button onclick="navigate('admin')" class="w-full flex items-center gap-4 px-4 py-3 rounded-xl hover:bg-white/10 transition">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                            </svg>
                            <span class="font-medium">Admin Panel</span>
                        </button>
                    </div>
                ` : ''}
                
                <div class="border-t border-white/10 pt-4 mt-4">
                    <button onclick="logout()" class="w-full flex items-center gap-4 px-4 py-3 rounded-xl hover:bg-red-500/20 text-red-400 transition">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                        </svg>
                        <span class="font-medium">Logout</span>
                    </button>
                </div>
            </aside>
        `;

        // Bottom Navigation (Mobile)
        const BottomNav = () => `
            <nav class="lg:hidden fixed bottom-0 left-0 right-0 h-16 bg-black/95 backdrop-blur-lg border-t border-white/10 flex items-center justify-around px-4 z-50">
                ${[
                    { icon: 'M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6', page: 'feed' },
                    { icon: 'M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z', page: 'search' },
                    { icon: 'M12 4v16m8-8H4', page: 'create' },
                    { icon: 'M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z', page: 'messages', badge: state.messages.reduce((acc, m) => acc + m.unread, 0) },
                    { icon: 'M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z', page: 'profile' },
                ].map(item => `
                    <button onclick="navigate('${item.page}')" class="relative p-3 rounded-xl ${state.currentPage === item.page ? 'bg-white/10' : 'hover:bg-white/5'} transition">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${item.icon}"/>
                        </svg>
                        ${item.badge ? `<span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>` : ''}
                    </button>
                `).join('')}
            </nav>
        `;

        // Story Card Component
        const StoryCard = (user, isOwn = false) => `
            <div class="flex-shrink-0 flex flex-col items-center gap-2 cursor-pointer">
                <div class="w-16 h-16 rounded-full p-0.5 bg-gradient-to-br ${isOwn ? 'from-gray-600 to-gray-800' : 'from-white to-gray-400'}">
                    <div class="w-full h-full rounded-full bg-black p-0.5">
                        <img src="${user.avatar}" class="w-full h-full rounded-full object-cover" />
                    </div>
                </div>
                <span class="text-xs text-gray-400 truncate w-16 text-center">${isOwn ? 'Your Story' : user.username.split('_')[0]}</span>
            </div>
        `;

        // Post Card Component
        const PostCard = (post) => {
            const user = getUser(post.userId);
            return `
                <article class="bg-neutral-900 rounded-2xl overflow-hidden card-hover">
                    <div class="p-4 flex items-center gap-3">
                        <img src="${user.avatar}" class="w-10 h-10 rounded-full cursor-pointer" onclick="viewProfile(${user.id})" />
                        <div class="flex-1">
                            <p class="font-semibold cursor-pointer hover:underline" onclick="viewProfile(${user.id})">${user.username}</p>
                            <p class="text-xs text-gray-500">${formatTime(post.createdAt)}</p>
                        </div>
                        <button class="p-2 hover:bg-white/10 rounded-full transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01"/>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="relative" ondblclick="likePost(${post.id})">
                        <img src="${post.image}" class="w-full aspect-square object-cover" />
                    </div>
                    
                    <div class="p-4 space-y-3">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <button onclick="likePost(${post.id})" class="p-1 hover:scale-110 transition">
                                    <svg class="w-7 h-7 ${post.liked ? 'fill-red-500 text-red-500' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                                    </svg>
                                </button>
                                <button onclick="viewPost(${post.id})" class="p-1 hover:scale-110 transition">
                                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                                    </svg>
                                </button>
                                <button class="p-1 hover:scale-110 transition">
                                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                                    </svg>
                                </button>
                            </div>
                            <button onclick="savePost(${post.id})" class="p-1 hover:scale-110 transition">
                                <svg class="w-7 h-7 ${post.saved ? 'fill-white' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"/>
                                </svg>
                            </button>
                        </div>
                        
                        <p class="font-semibold">${formatNumber(post.likes)} likes</p>
                        
                        <p class="text-sm">
                            <span class="font-semibold">${user.username}</span>
                            <span class="text-gray-300">${post.caption}</span>
                        </p>
                        
                        <button onclick="viewPost(${post.id})" class="text-gray-500 text-sm">View all ${post.comments} comments</button>
                        
                        <div class="flex items-center gap-3 pt-2 border-t border-white/10">
                            <input type="text" placeholder="Add a comment..." class="flex-1 bg-transparent outline-none text-sm" />
                            <button class="text-white/50 hover:text-white font-semibold text-sm transition">Post</button>
                        </div>
                    </div>
                </article>
            `;
        };

        // Suggestion Card Component
        const SuggestionCard = (user) => `
            <div class="flex items-center gap-3 p-3 hover:bg-white/5 rounded-xl transition">
                <img src="${user.avatar}" class="w-10 h-10 rounded-full cursor-pointer" onclick="viewProfile(${user.id})" />
                <div class="flex-1 min-w-0">
                    <p class="font-semibold text-sm truncate cursor-pointer hover:underline" onclick="viewProfile(${user.id})">${user.username}</p>
                    <p class="text-xs text-gray-500 truncate">${formatNumber(user.followers)} followers</p>
                </div>
                <button onclick="toggleFollow(${user.id})" class="text-sm font-semibold ${user.isFollowing ? 'text-gray-400' : 'text-blue-400'} hover:opacity-80">
                    ${user.isFollowing ? 'Following' : 'Follow'}
                </button>
            </div>
        `;

        // Message Item Component
        const MessageItem = (chat) => {
            const user = getUser(chat.recipientId);
            const lastMessage = chat.messages[chat.messages.length - 1];
            return `
                <div onclick="openChat(${chat.id})" class="flex items-center gap-3 p-4 hover:bg-white/5 rounded-xl transition cursor-pointer ${state.activeChat === chat.id ? 'bg-white/10' : ''}">
                    <div class="relative">
                        <img src="${user.avatar}" class="w-14 h-14 rounded-full" />
                        <span class="absolute bottom-0 right-0 w-3.5 h-3.5 bg-green-500 border-2 border-neutral-900 rounded-full"></span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center justify-between">
                            <p class="font-semibold">${user.displayName}</p>
                            <span class="text-xs text-gray-500">${formatTime(lastMessage.time)}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            ${chat.typing ? `
                                <div class="flex items-center gap-1">
                                    <span class="typing-dot w-1.5 h-1.5 bg-gray-400 rounded-full"></span>
                                    <span class="typing-dot w-1.5 h-1.5 bg-gray-400 rounded-full"></span>
                                    <span class="typing-dot w-1.5 h-1.5 bg-gray-400 rounded-full"></span>
                                </div>
                            ` : `
                                <p class="text-sm text-gray-400 truncate">${lastMessage.senderId === 'me' ? 'You: ' : ''}${lastMessage.text}</p>
                            `}
                            ${chat.unread > 0 ? `<span class="ml-auto bg-red-500 text-xs px-2 py-0.5 rounded-full">${chat.unread}</span>` : ''}
                        </div>
                    </div>
                </div>
            `;
        };

        // Chat Window Component
        const ChatWindow = (chat) => {
            const user = getUser(chat.recipientId);
            return `
                <div class="flex flex-col h-full">
                    <div class="flex items-center gap-3 p-4 border-b border-white/10">
                        <button onclick="closeChat()" class="p-2 hover:bg-white/10 rounded-full transition lg:hidden">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                            </svg>
                        </button>
                        <img src="${user.avatar}" class="w-10 h-10 rounded-full" />
                        <div class="flex-1">
                            <p class="font-semibold">${user.displayName}</p>
                            <p class="text-xs text-green-400">Active now</p>
                        </div>
                        <button class="p-2 hover:bg-white/10 rounded-full transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto p-4 space-y-4">
                        ${chat.messages.map(msg => `
                            <div class="flex ${msg.senderId === 'me' ? 'justify-end' : 'justify-start'}">
                                <div class="max-w-[70%] ${msg.senderId === 'me' ? 'bg-white text-black' : 'bg-neutral-800'} rounded-2xl px-4 py-2">
                                    <p class="text-sm">${msg.text}</p>
                                    <div class="flex items-center justify-end gap-1 mt-1">
                                        <span class="text-xs ${msg.senderId === 'me' ? 'text-gray-600' : 'text-gray-500'}">${formatTime(msg.time)}</span>
                                        ${msg.senderId === 'me' ? `
                                            <svg class="w-4 h-4 ${msg.status === 'seen' ? 'text-blue-500' : 'text-gray-600'}" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M18 7l-8.5 8.5-4-4M22 7l-8.5 8.5-4-4"/>
                                            </svg>
                                        ` : ''}
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                        ${chat.typing ? `
                            <div class="flex justify-start">
                                <div class="bg-neutral-800 rounded-2xl px-4 py-3 flex items-center gap-1">
                                    <span class="typing-dot w-2 h-2 bg-gray-400 rounded-full"></span>
                                    <span class="typing-dot w-2 h-2 bg-gray-400 rounded-full"></span>
                                    <span class="typing-dot w-2 h-2 bg-gray-400 rounded-full"></span>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="p-4 border-t border-white/10">
                        <div class="flex items-center gap-3 bg-neutral-800 rounded-full px-4 py-2">
                            <button class="p-1 hover:bg-white/10 rounded-full transition">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </button>
                            <input type="text" placeholder="Message..." class="flex-1 bg-transparent outline-none" id="messageInput" onkeypress="if(event.key==='Enter')sendMessage(${chat.id})" />
                            <button class="p-1 hover:bg-white/10 rounded-full transition">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                </svg>
                            </button>
                            <button onclick="sendMessage(${chat.id})" class="p-1 hover:bg-white/10 rounded-full transition">
                                <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        };

        // ==================== PAGES ====================

        // Login Page
        const LoginPage = () => `
            <div class="min-h-screen auth-gradient flex items-center justify-center p-4">
                <div class="w-full max-w-5xl flex flex-col lg:flex-row items-center gap-12">
                    <div class="flex-1 flex flex-col items-center text-center">
                        ${AnimatedSphere()}
                        <h1 class="text-4xl lg:text-5xl font-bold mt-12 mb-4">PixelSphere</h1>
                        <p class="text-gray-400 max-w-sm">Share your moments, connect with creators, and discover amazing content.</p>
                    </div>
                    
                    <div class="w-full max-w-md auth-slide-${state.authDirection}">
                        <div class="bg-neutral-900/50 backdrop-blur-xl rounded-3xl p-8 border border-white/10 shadow-2xl">
                            <h2 class="text-2xl font-bold mb-6">Welcome back</h2>
                            
                            <form onsubmit="handleLogin(event)" class="space-y-4">
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Username or Email</label>
                                    <input type="text" id="loginEmail" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" placeholder="Enter your username" />
                                </div>
                                
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Password</label>
                                    <input type="password" id="loginPassword" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" placeholder="Enter your password" />
                                </div>
                                
                                <div class="flex items-center justify-between text-sm">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" class="rounded bg-white/10 border-white/20" />
                                        <span class="text-gray-400">Remember me</span>
                                    </label>
                                    <a href="#" class="text-white hover:underline">Forgot password?</a>
                                </div>
                                
                                <button type="submit" class="w-full bg-white text-black font-semibold py-3 rounded-xl btn-hover mt-6">
                                    Sign In
                                </button>
                            </form>
                            
                            <div class="flex items-center gap-4 my-6">
                                <div class="flex-1 h-px bg-white/10"></div>
                                <span class="text-gray-500 text-sm">or</span>
                                <div class="flex-1 h-px bg-white/10"></div>
                            </div>
                            
                            <button class="w-full bg-white/5 border border-white/10 py-3 rounded-xl flex items-center justify-center gap-3 hover:bg-white/10 transition">
                                <svg class="w-5 h-5" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                    <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                    <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                    <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                </svg>
                                Continue with Google
                            </button>
                            
                            <p class="text-center text-gray-400 mt-6">
                                Don't have an account? 
                                <button onclick="navigateAuth('signup')" class="text-white font-semibold hover:underline">Sign up</button>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        `;

        // Signup Page
        const SignupPage = () => `
            <div class="min-h-screen auth-gradient flex items-center justify-center p-4">
                <div class="w-full max-w-5xl flex flex-col lg:flex-row items-center gap-12">
                    <div class="flex-1 flex flex-col items-center text-center">
                        ${AnimatedSphere()}
                        <h1 class="text-4xl lg:text-5xl font-bold mt-12 mb-4">PixelSphere</h1>
                        <p class="text-gray-400 max-w-sm">Join millions of creators and start sharing your story today.</p>
                    </div>
                    
                    <div class="w-full max-w-md auth-slide-${state.authDirection}">
                        <div class="bg-neutral-900/50 backdrop-blur-xl rounded-3xl p-8 border border-white/10 shadow-2xl">
                            <h2 class="text-2xl font-bold mb-6">Create account</h2>
                            
                            <form onsubmit="handleSignup(event)" class="space-y-4">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm text-gray-400 mb-2">First Name</label>
                                        <input type="text" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" placeholder="John" />
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-400 mb-2">Last Name</label>
                                        <input type="text" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" placeholder="Doe" />
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Username</label>
                                    <input type="text" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" placeholder="johndoe" />
                                </div>
                                
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Email</label>
                                    <input type="email" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" placeholder="john@example.com" />
                                </div>
                                
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Password</label>
                                    <input type="password" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" placeholder="Create a password" />
                                </div>
                                
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Account Type</label>
                                    <select class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition">
                                        <option value="creator" class="bg-neutral-900">Creator - I want to post content</option>
                                        <option value="consumer" class="bg-neutral-900">Consumer - I just want to browse</option>
                                    </select>
                                </div>
                                
                                <label class="flex items-start gap-3 cursor-pointer">
                                    <input type="checkbox" required class="mt-1 rounded bg-white/10 border-white/20" />
                                    <span class="text-sm text-gray-400">I agree to the <a href="#" class="text-white hover:underline">Terms of Service</a> and <a href="#" class="text-white hover:underline">Privacy Policy</a></span>
                                </label>
                                
                                <button type="submit" class="w-full bg-white text-black font-semibold py-3 rounded-xl btn-hover mt-6">
                                    Create Account
                                </button>
                            </form>
                            
                            <p class="text-center text-gray-400 mt-6">
                                Already have an account? 
                                <button onclick="navigateAuth('login')" class="text-white font-semibold hover:underline">Sign in</button>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        `;

        // Feed Page
        const FeedPage = () => `
            <div class="pt-16 pb-20 lg:pb-0 lg:pl-64 lg:pr-80">
                <div class="max-w-xl mx-auto p-4 space-y-6">
                    <!-- Stories -->
                    <div class="bg-neutral-900 rounded-2xl p-4">
                        <div class="flex gap-4 overflow-x-auto hide-scrollbar pb-2">
                            ${StoryCard(state.user || state.users[0], true)}
                            ${state.users.slice(0, 5).map(u => StoryCard(u)).join('')}
                        </div>
                    </div>
                    
                    <!-- Posts -->
                    <div class="space-y-6">
                        ${state.posts.map(post => PostCard(post)).join('')}
                    </div>
                </div>
            </div>
        `;

        // Search Page
        const SearchPage = () => `
            <div class="pt-16 pb-20 lg:pb-0 lg:pl-64 lg:pr-80">
                <div class="max-w-2xl mx-auto p-4">
                    <div class="flex items-center bg-neutral-900 rounded-2xl px-4 py-3 mb-6">
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                        <input type="text" placeholder="Search users, hashtags..." class="bg-transparent border-none outline-none ml-3 w-full" value="${state.searchQuery}" oninput="handleSearch(this.value)" />
                    </div>
                    
                    ${state.searchQuery ? `
                        <div class="space-y-2">
                            <h3 class="text-gray-400 text-sm font-medium px-2">Results</h3>
                            ${state.users.filter(u => 
                                u.username.toLowerCase().includes(state.searchQuery.toLowerCase()) ||
                                u.displayName.toLowerCase().includes(state.searchQuery.toLowerCase())
                            ).map(user => `
                                <div onclick="viewProfile(${user.id})" class="flex items-center gap-4 p-4 bg-neutral-900 rounded-2xl cursor-pointer hover:bg-neutral-800 transition">
                                    <img src="${user.avatar}" class="w-14 h-14 rounded-full" />
                                    <div class="flex-1">
                                        <p class="font-semibold">${user.username}</p>
                                        <p class="text-sm text-gray-400">${user.displayName}</p>
                                        <p class="text-xs text-gray-500">${formatNumber(user.followers)} followers</p>
                                    </div>
                                    <button onclick="event.stopPropagation(); toggleFollow(${user.id})" class="px-4 py-2 ${user.isFollowing ? 'bg-neutral-700' : 'bg-white text-black'} rounded-xl font-semibold text-sm">
                                        ${user.isFollowing ? 'Following' : 'Follow'}
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div class="space-y-6">
                            <div>
                                <h3 class="text-gray-400 text-sm font-medium mb-3">Suggested for you</h3>
                                <div class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                                    ${state.users.slice(0, 6).map(user => `
                                        <div onclick="viewProfile(${user.id})" class="bg-neutral-900 rounded-2xl p-4 text-center cursor-pointer card-hover">
                                            <img src="${user.avatar}" class="w-16 h-16 rounded-full mx-auto mb-3" />
                                            <p class="font-semibold text-sm truncate">${user.username}</p>
                                            <p class="text-xs text-gray-500">${formatNumber(user.followers)} followers</p>
                                            <button onclick="event.stopPropagation(); toggleFollow(${user.id})" class="mt-3 w-full py-2 ${user.isFollowing ? 'bg-neutral-700' : 'bg-white text-black'} rounded-xl font-semibold text-xs">
                                                ${user.isFollowing ? 'Following' : 'Follow'}
                                            </button>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-gray-400 text-sm font-medium mb-3">Explore</h3>
                                <div class="grid grid-cols-3 gap-1">
                                    ${[1,2,3,4,5,6,7,8,9].map(i => `
                                        <div class="aspect-square bg-neutral-900 rounded-lg overflow-hidden cursor-pointer hover:opacity-80 transition">
                                            <img src="https://picsum.photos/300/300?random=${i+10}" class="w-full h-full object-cover" />
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `}
                </div>
            </div>
        `;

        // Messages Page
        const MessagesPage = () => `
            <div class="pt-16 pb-20 lg:pb-0 lg:pl-64 lg:pr-0">
                <div class="h-[calc(100vh-4rem)] lg:h-[calc(100vh-4rem)] flex">
                    <!-- Chat List -->
                    <div class="${state.activeChat ? 'hidden lg:block' : ''} w-full lg:w-96 border-r border-white/10 overflow-y-auto">
                        <div class="p-4 border-b border-white/10">
                            <h2 class="text-xl font-bold">Messages</h2>
                        </div>
                        <div class="p-2">
                            ${state.messages.map(chat => MessageItem(chat)).join('')}
                        </div>
                    </div>
                    
                    <!-- Chat Window -->
                    <div class="${state.activeChat ? 'block' : 'hidden lg:flex'} flex-1 ${state.activeChat ? '' : 'items-center justify-center'}">
                        ${state.activeChat ? ChatWindow(state.messages.find(m => m.id === state.activeChat)) : `
                            <div class="text-center text-gray-500">
                                <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                                </svg>
                                <p class="font-semibold text-lg">Your Messages</p>
                                <p class="text-sm mt-1">Select a chat to start messaging</p>
                            </div>
                        `}
                    </div>
                </div>
            </div>
        `;

        // Profile Page
        const ProfilePage = (userId = null) => {
            const user = userId ? getUser(userId) : (state.user || state.users[0]);
            const userPosts = state.posts.filter(p => p.userId === user.id);
            const isOwn = !userId || userId === state.user?.id;
            
            return `
                <div class="pt-16 pb-20 lg:pb-0 lg:pl-64 lg:pr-80">
                    <div class="max-w-3xl mx-auto p-4">
                        <!-- Profile Header -->
                        <div class="flex flex-col sm:flex-row items-center gap-8 mb-8">
                            <div class="w-24 h-24 sm:w-36 sm:h-36 rounded-full overflow-hidden ring-4 ring-white/10">
                                <img src="${user.avatar}" class="w-full h-full object-cover" />
                            </div>
                            
                            <div class="flex-1 text-center sm:text-left">
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                                    <h1 class="text-xl font-semibold">${user.username}</h1>
                                    ${isOwn ? `
                                        <div class="flex gap-2">
                                            <button onclick="navigate('editProfile')" class="px-4 py-2 bg-neutral-800 rounded-xl font-semibold text-sm hover:bg-neutral-700 transition">Edit Profile</button>
                                            <button class="p-2 bg-neutral-800 rounded-xl hover:bg-neutral-700 transition">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                                </svg>
                                            </button>
                                        </div>
                                    ` : `
                                        <div class="flex gap-2">
                                            <button onclick="toggleFollow(${user.id})" class="px-6 py-2 ${user.isFollowing ? 'bg-neutral-800' : 'bg-white text-black'} rounded-xl font-semibold text-sm">
                                                ${user.isFollowing ? 'Following' : 'Follow'}
                                            </button>
                                            <button class="px-4 py-2 bg-neutral-800 rounded-xl font-semibold text-sm hover:bg-neutral-700 transition">Message</button>
                                        </div>
                                    `}
                                </div>
                                
                                <div class="flex justify-center sm:justify-start gap-8 mb-4">
                                    <div class="text-center">
                                        <p class="font-bold">${user.posts}</p>
                                        <p class="text-sm text-gray-400">posts</p>
                                    </div>
                                    <div class="text-center cursor-pointer">
                                        <p class="font-bold">${formatNumber(user.followers)}</p>
                                        <p class="text-sm text-gray-400">followers</p>
                                    </div>
                                    <div class="text-center cursor-pointer">
                                        <p class="font-bold">${formatNumber(user.following)}</p>
                                        <p class="text-sm text-gray-400">following</p>
                                    </div>
                                </div>
                                
                                <div>
                                    <p class="font-semibold">${user.displayName}</p>
                                    <p class="text-sm text-gray-400 mt-1">${user.bio}</p>
                                    ${user.role === 'creator' ? '<span class="inline-block mt-2 px-2 py-1 bg-white/10 rounded-lg text-xs">Creator</span>' : ''}
                                </div>
                            </div>
                        </div>
                        
                        <!-- Profile Tabs -->
                        <div class="flex border-t border-white/10">
                            <button class="flex-1 py-4 border-t-2 border-white flex items-center justify-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
                                </svg>
                                <span class="text-sm font-medium">Posts</span>
                            </button>
                            <button class="flex-1 py-4 border-t-2 border-transparent text-gray-500 flex items-center justify-center gap-2 hover:text-white transition">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"/>
                                </svg>
                                <span class="text-sm font-medium">Saved</span>
                            </button>
                        </div>
                        
                        <!-- Posts Grid -->
                        <div class="profile-grid mt-4">
                            ${userPosts.length > 0 ? userPosts.map(post => `
                                <div onclick="viewPost(${post.id})" class="aspect-square bg-neutral-900 rounded-lg overflow-hidden cursor-pointer group relative">
                                    <img src="${post.image}" class="w-full h-full object-cover" />
                                    <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition flex items-center justify-center gap-4">
                                        <span class="flex items-center gap-1">
                                            <svg class="w-5 h-5" fill="white" viewBox="0 0 24 24">
                                                <path d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                                            </svg>
                                            ${formatNumber(post.likes)}
                                        </span>
                                        <span class="flex items-center gap-1">
                                            <svg class="w-5 h-5" fill="white" viewBox="0 0 24 24">
                                                <path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                                            </svg>
                                            ${post.comments}
                                        </span>
                                    </div>
                                </div>
                            `).join('') : `
                                <div class="col-span-3 text-center py-12 text-gray-500">
                                    <svg class="w-12 h-12 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/>
                                    </svg>
                                    <p>No posts yet</p>
                                </div>
                            `}
                        </div>
                    </div>
                </div>
            `;
        };

        // Edit Profile Page
        const EditProfilePage = () => {
            const user = state.user || state.users[0];
            return `
                <div class="pt-16 pb-20 lg:pb-0 lg:pl-64 lg:pr-80">
                    <div class="max-w-xl mx-auto p-4">
                        <div class="bg-neutral-900 rounded-2xl p-6">
                            <h2 class="text-xl font-bold mb-6">Edit Profile</h2>
                            
                            <div class="flex items-center gap-4 mb-6">
                                <div class="w-20 h-20 rounded-full overflow-hidden">
                                    <img src="${user.avatar}" class="w-full h-full object-cover" />
                                </div>
                                <button class="text-blue-400 font-semibold hover:underline">Change Profile Photo</button>
                            </div>
                            
                            <form class="space-y-4">
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Username</label>
                                    <input type="text" value="${user.username}" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" />
                                </div>
                                
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Display Name</label>
                                    <input type="text" value="${user.displayName}" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" />
                                </div>
                                
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Bio</label>
                                    <textarea rows="3" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition resize-none">${user.bio}</textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">Email</label>
                                    <input type="email" value="user@example.com" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" />
                                </div>
                                
                                <div class="flex gap-3 pt-4">
                                    <button type="button" onclick="navigate('profile')" class="flex-1 py-3 bg-neutral-800 rounded-xl font-semibold hover:bg-neutral-700 transition">Cancel</button>
                                    <button type="submit" class="flex-1 py-3 bg-white text-black rounded-xl font-semibold btn-hover">Save Changes</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            `;
        };

        // Create Post Page
        const CreatePostPage = () => `
            <div class="pt-16 pb-20 lg:pb-0 lg:pl-64 lg:pr-80">
                <div class="max-w-xl mx-auto p-4">
                    <div class="bg-neutral-900 rounded-2xl p-6">
                        <h2 class="text-xl font-bold mb-6">Create New Post</h2>
                        
                        <div class="border-2 border-dashed border-white/20 rounded-2xl p-8 text-center mb-6 hover:border-white/40 transition cursor-pointer" onclick="document.getElementById('fileInput').click()">
                            <input type="file" id="fileInput" accept="image/*" class="hidden" onchange="previewImage(event)" />
                            <div id="uploadPreview" class="hidden mb-4">
                                <img id="previewImg" class="max-h-64 mx-auto rounded-xl" />
                            </div>
                            <div id="uploadPlaceholder">
                                <svg class="w-16 h-16 mx-auto mb-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                </svg>
                                <p class="text-gray-400">Click to upload from gallery</p>
                                <p class="text-sm text-gray-500 mt-1">JPG, PNG up to 10MB</p>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Caption</label>
                                <textarea rows="4" placeholder="Write a caption..." class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition resize-none"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Location (optional)</label>
                                <input type="text" placeholder="Add location" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-white/30 transition" />
                            </div>
                            
                            <button class="w-full py-3 bg-white text-black rounded-xl font-semibold btn-hover">Share Post</button>
                        </div>
                    </div>
                </div>
            </div>
        `;

        // Admin Dashboard Page
        const AdminPage = () => `
            <div class="pt-16 pb-20 lg:pb-0 lg:pl-64 lg:pr-0">
                <div class="max-w-6xl mx-auto p-4">
                    <h1 class="text-2xl font-bold mb-6">Admin Dashboard</h1>
                    
                    <!-- Stats -->
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                        ${[
                            { label: 'Total Users', value: '12,345', icon: 'M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z' },
                            { label: 'Total Posts', value: '45,678', icon: 'M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z' },
                            { label: 'Active Today', value: '2,345', icon: 'M13 10V3L4 14h7v7l9-11h-7z' },
                            { label: 'Reports', value: '23', icon: 'M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z' },
                        ].map(stat => `
                            <div class="bg-neutral-900 rounded-2xl p-6">
                                <div class="flex items-center gap-4">
                                    <div class="p-3 bg-white/10 rounded-xl">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${stat.icon}"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <p class="text-2xl font-bold">${stat.value}</p>
                                        <p class="text-sm text-gray-400">${stat.label}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <!-- Users Table -->
                    <div class="bg-neutral-900 rounded-2xl overflow-hidden">
                        <div class="p-4 border-b border-white/10 flex items-center justify-between">
                            <h2 class="font-semibold">Manage Users</h2>
                            <div class="flex items-center gap-2">
                                <input type="text" placeholder="Search users..." class="bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-sm outline-none" />
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-white/5">
                                    <tr>
                                        <th class="text-left p-4 text-sm text-gray-400 font-medium">User</th>
                                        <th class="text-left p-4 text-sm text-gray-400 font-medium">Role</th>
                                        <th class="text-left p-4 text-sm text-gray-400 font-medium">Posts</th>
                                        <th class="text-left p-4 text-sm text-gray-400 font-medium">Followers</th>
                                        <th class="text-left p-4 text-sm text-gray-400 font-medium">Status</th>
                                        <th class="text-left p-4 text-sm text-gray-400 font-medium">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${state.users.map(user => `
                                        <tr class="border-t border-white/5 hover:bg-white/5">
                                            <td class="p-4">
                                                <div class="flex items-center gap-3">
                                                    <img src="${user.avatar}" class="w-10 h-10 rounded-full" />
                                                    <div>
                                                        <p class="font-medium">${user.username}</p>
                                                        <p class="text-sm text-gray-500">${user.displayName}</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="p-4">
                                                <span class="px-2 py-1 ${user.role === 'admin' ? 'bg-purple-500/20 text-purple-400' : user.role === 'creator' ? 'bg-blue-500/20 text-blue-400' : 'bg-gray-500/20 text-gray-400'} rounded-lg text-xs">${user.role}</span>
                                            </td>
                                            <td class="p-4 text-gray-400">${user.posts}</td>
                                            <td class="p-4 text-gray-400">${formatNumber(user.followers)}</td>
                                            <td class="p-4">
                                                <span class="px-2 py-1 bg-green-500/20 text-green-400 rounded-lg text-xs">Active</span>
                                            </td>
                                            <td class="p-4">
                                                <div class="flex gap-2">
                                                    <button class="p-2 hover:bg-white/10 rounded-lg transition" title="View">
                                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                                        </svg>
                                                    </button>
                                                    <button class="p-2 hover:bg-red-500/20 text-red-400 rounded-lg transition" title="Ban">
                                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/>
                                                        </svg>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        `;

        // Post Details Modal
        const PostDetailsPage = () => {
            const post = state.posts.find(p => p.id === state.selectedPost);
            if (!post) return '';
            const user = getUser(post.userId);
            
            return `
                <div class="fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4" onclick="closePost(event)">
                    <div class="bg-neutral-900 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col lg:flex-row" onclick="event.stopPropagation()">
                        <div class="lg:w-2/3 bg-black flex items-center justify-center">
                            <img src="${post.image}" class="max-w-full max-h-[50vh] lg:max-h-[90vh] object-contain" />
                        </div>
                        <div class="lg:w-1/3 flex flex-col">
                            <div class="p-4 border-b border-white/10 flex items-center gap-3">
                                <img src="${user.avatar}" class="w-10 h-10 rounded-full" />
                                <div class="flex-1">
                                    <p class="font-semibold">${user.username}</p>
                                    <p class="text-xs text-gray-500">${formatTime(post.createdAt)}</p>
                                </div>
                                <button onclick="closePost()" class="p-2 hover:bg-white/10 rounded-full transition">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                    </svg>
                                </button>
                            </div>
                            
                            <div class="flex-1 overflow-y-auto p-4 space-y-4">
                                <p class="text-sm">
                                    <span class="font-semibold">${user.username}</span>
                                    <span class="text-gray-300">${post.caption}</span>
                                </p>
                                
                                <!-- Sample Comments -->
                                ${[
                                    { user: state.users[1], text: 'Amazing work! ðŸ”¥' },
                                    { user: state.users[2], text: 'Love the vibes here' },
                                    { user: state.users[3], text: 'This is incredible!' },
                                ].map(c => `
                                    <div class="flex gap-3">
                                        <img src="${c.user.avatar}" class="w-8 h-8 rounded-full" />
                                        <div>
                                            <p class="text-sm">
                                                <span class="font-semibold">${c.user.username}</span>
                                                <span class="text-gray-300">${c.text}</span>
                                            </p>
                                            <p class="text-xs text-gray-500 mt-1">2h â€¢ Reply</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <div class="border-t border-white/10 p-4">
                                <div class="flex items-center justify-between mb-3">
                                    <div class="flex items-center gap-4">
                                        <button onclick="likePost(${post.id})" class="hover:scale-110 transition">
                                            <svg class="w-6 h-6 ${post.liked ? 'fill-red-500 text-red-500' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                                            </svg>
                                        </button>
                                        <button class="hover:scale-110 transition">
                                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                                            </svg>
                                        </button>
                                        <button class="hover:scale-110 transition">
                                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                                            </svg>
                                        </button>
                                    </div>
                                    <button onclick="savePost(${post.id})" class="hover:scale-110 transition">
                                        <svg class="w-6 h-6 ${post.saved ? 'fill-white' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"/>
                                        </svg>
                                    </button>
                                </div>
                                <p class="font-semibold text-sm">${formatNumber(post.likes)} likes</p>
                                
                                <div class="flex items-center gap-3 mt-3 pt-3 border-t border-white/10">
                                    <input type="text" placeholder="Add a comment..." class="flex-1 bg-transparent outline-none text-sm" />
                                    <button class="text-white/50 hover:text-white font-semibold text-sm transition">Post</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        };

        // Right Sidebar (Suggestions Panel)
        const RightSidebar = () => `
            <aside class="hidden xl:block fixed right-0 top-16 bottom-0 w-80 border-l border-white/10 p-4 overflow-y-auto">
                <!-- User Info -->
                <div class="flex items-center gap-3 mb-6">
                    <img src="${state.user?.avatar || 'https://i.pravatar.cc/150?img=8'}" class="w-12 h-12 rounded-full" />
                    <div class="flex-1">
                        <p class="font-semibold">${state.user?.username || 'current_user'}</p>
                        <p class="text-sm text-gray-500">${state.user?.displayName || 'Current User'}</p>
                    </div>
                    <button class="text-blue-400 text-sm font-semibold">Switch</button>
                </div>
                
                <!-- Suggestions -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-3">
                        <p class="text-gray-400 text-sm font-medium">Suggested for you</p>
                        <button class="text-sm font-semibold hover:text-gray-300">See All</button>
                    </div>
                    <div class="space-y-1">
                        ${state.users.filter(u => !u.isFollowing).slice(0, 5).map(user => SuggestionCard(user)).join('')}
                    </div>
                </div>
                
                <!-- Footer -->
                <div class="text-xs text-gray-600 space-y-2">
                    <p>About Â· Help Â· Press Â· API Â· Jobs Â· Privacy Â· Terms</p>
                    <p>Â© 2024 PixelSphere</p>
                </div>
            </aside>
        `;

        // Not Found Page
        const NotFoundPage = () => `
            <div class="pt-16 pb-20 lg:pb-0 lg:pl-64 flex items-center justify-center min-h-[80vh]">
                <div class="text-center">
                    <h1 class="text-6xl font-bold mb-4">404</h1>
                    <p class="text-gray-400 mb-6">Page not found</p>
                    <button onclick="navigate('feed')" class="px-6 py-3 bg-white text-black rounded-xl font-semibold btn-hover">Go Home</button>
                </div>
            </div>
        `;

        // ==================== ACTIONS ====================
        
        function navigate(page) {
            state.showNotifications = false;
            state.currentPage = page;
            render();
        }

        function navigateAuth(page) {
            state.authDirection = page === 'signup' ? 'left' : 'right';
            state.currentPage = page;
            render();
        }

        function handleLogin(e) {
            e.preventDefault();
            state.isAuthenticated = true;
            state.user = { ...state.users[0], id: 'me' };
            state.currentPage = 'feed';
            render();
        }

        function handleSignup(e) {
            e.preventDefault();
            state.isAuthenticated = true;
            state.user = { ...state.users[0], id: 'me' };
            state.currentPage = 'feed';
            render();
        }

        function logout() {
            state.isAuthenticated = false;
            state.user = null;
            state.currentPage = 'login';
            render();
        }

        function handleSearch(query) {
            state.searchQuery = query;
            if (state.currentPage !== 'search') {
                state.currentPage = 'search';
            }
            render();
        }

        function toggleFollow(userId) {
            const user = state.users.find(u => u.id === userId);
            if (user) {
                user.isFollowing = !user.isFollowing;
                user.followers += user.isFollowing ? 1 : -1;
            }
            render();
        }

        function likePost(postId) {
            const post = state.posts.find(p => p.id === postId);
            if (post) {
                post.liked = !post.liked;
                post.likes += post.liked ? 1 : -1;
            }
            render();
        }

        function savePost(postId) {
            const post = state.posts.find(p => p.id === postId);
            if (post) {
                post.saved = !post.saved;
            }
            render();
        }

        function viewPost(postId) {
            state.selectedPost = postId;
            render();
        }

        function closePost(e) {
            if (!e || e.target === e.currentTarget) {
                state.selectedPost = null;
                render();
            }
        }

        function viewProfile(userId) {
            state.viewingUserId = userId;
            state.currentPage = 'viewProfile';
            render();
        }

        function openChat(chatId) {
            state.activeChat = chatId;
            const chat = state.messages.find(m => m.id === chatId);
            if (chat) {
                chat.unread = 0;
            }
            render();
        }

        function closeChat() {
            state.activeChat = null;
            render();
        }

        function sendMessage(chatId) {
            const input = document.getElementById('messageInput');
            if (input && input.value.trim()) {
                const chat = state.messages.find(m => m.id === chatId);
                if (chat) {
                    chat.messages.push({
                        id: chat.messages.length + 1,
                        senderId: 'me',
                        text: input.value.trim(),
                        time: new Date(),
                        status: 'sent'
                    });
                    input.value = '';
                    render();
                    
                    // Simulate delivery
                    setTimeout(() => {
                        chat.messages[chat.messages.length - 1].status = 'delivered';
                        render();
                    }, 1000);
                }
            }
        }

        function toggleNotifications() {
            state.showNotifications = !state.showNotifications;
            if (state.showNotifications) {
                state.notifications.forEach(n => n.read = true);
            }
            render();
        }

        function previewImage(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('previewImg').src = e.target.result;
                    document.getElementById('uploadPreview').classList.remove('hidden');
                    document.getElementById('uploadPlaceholder').classList.add('hidden');
                }
                reader.readAsDataURL(file);
            }
        }

        // ==================== RENDER ====================
        
        function render() {
            const app = document.getElementById('app');
            let content = '';
            
            if (!state.isAuthenticated) {
                if (state.currentPage === 'signup') {
                    content = SignupPage();
                } else {
                    content = LoginPage();
                }
            } else {
                // Authenticated layout
                content = Navbar();
                content += Sidebar();
                
                switch(state.currentPage) {
                    case 'feed':
                    case 'home':
                        content += FeedPage();
                        content += RightSidebar();
                        break;
                    case 'search':
                        content += SearchPage();
                        break;
                    case 'messages':
                        content += MessagesPage();
                        break;
                    case 'profile':
                        content += ProfilePage();
                        break;
                    case 'viewProfile':
                        content += ProfilePage(state.viewingUserId);
                        break;
                    case 'editProfile':
                        content += EditProfilePage();
                        break;
                    case 'create':
                        content += CreatePostPage();
                        break;
                    case 'admin':
                        content += AdminPage();
                        break;
                    default:
                        content += NotFoundPage();
                }
                
                content += BottomNav();
                
                if (state.selectedPost) {
                    content += PostDetailsPage();
                }
            }
            
            app.innerHTML = `<div class="page-enter">${content}</div>`;
        }

        // Initial render
        render();
    </script>
</body>
</html>